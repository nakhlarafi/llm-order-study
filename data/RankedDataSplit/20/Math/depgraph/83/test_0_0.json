{
    "bug_id": 83,
    "test_id": 0,
    "test_name": "org.apache.commons.math.optimization.linear.SimplexSolverTest.testMath286",
    "test_body": "52: public void testMath286() throws OptimizationException {\n53: LinearObjectiveFunction f = new LinearObjectiveFunction(new double[] { 0.2, 0.3 }, 0 );\n54: Collection<LinearConstraint> constraints = new ArrayList<LinearConstraint>();\n55: constraints.add(new LinearConstraint(new double[] { 1, 1 }, Relationship.EQ, 23.0));\n56: 57: RealPointValuePair solution = new SimplexSolver().optimize(f, constraints, GoalType.MAXIMIZE, true);\n58: assertEquals(6.9, solution.getValue(), .0000001);\n59: }\n",
    "stack_trace": "junit.framework.AssertionFailedError: expected:<6.9> but was:<4.6000000000000005>\nat org.junit.Assert.fail(Assert.java:88)\nat org.junit.Assert.failNotEquals(Assert.java:743)\nat org.junit.Assert.assertEquals(Assert.java:494)\nat org.junit.Assert.assertEquals(Assert.java:592)\nat org.apache.commons.math.optimization.linear.SimplexSolverTest.testMath286(SimplexSolverTest.java:58)",
    "covered_methods": [
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:createTableau(Z)[[D",
            "method_body": "protected double[][] createTableau(final boolean maximize) {\nList<LinearConstraint> constraints = getNormalizedConstraints();\nint width = numDecisionVariables + numSlackVariables +\nint height = constraints.size() + getNumObjectiveFunctions();\ndouble[][] matrix = new double[height][width];\nif (getNumObjectiveFunctions() == 2) {\nmatrix[0][0] = -1;\nint zIndex = (getNumObjectiveFunctions() == 1) ? 0 : 1;\nmatrix[zIndex][zIndex] = maximize ? 1 : -1;\nRealVector objectiveCoefficients =\ncopyArray(objectiveCoefficients.getData(), matrix[zIndex], getNumObjectiveFunctions());\nmatrix[zIndex][width - 1] =\nif (!restrictToNonNegative) {\nint slackVar = 0;\nint artificialVar = 0;\nfor (int i = 0; i < constraints.size(); i++) {\nLinearConstraint constraint = constraints.get(i);\nint row = getNumObjectiveFunctions() + i;\ncopyArray(constraint.getCoefficients().getData(), matrix[row], 1);\nif (!restrictToNonNegative) {\nmatrix[row][width - 1] = constraint.getValue();\nif (constraint.getRelationship() == Relationship.LEQ) {\n} else if (constraint.getRelationship() == Relationship.GEQ) {\nif ((constraint.getRelationship() == Relationship.EQ) ||\nmatrix[0][getArtificialVariableOffset() + artificialVar] = 1;\nmatrix[row][getArtificialVariableOffset() + artificialVar++] = 1;\nreturn matrix;\n}",
            "method_id": 0
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getSolution()Lorg/apache/commons/math/optimization/RealPointValuePair;",
            "method_body": "protected RealPointValuePair getSolution() {\ndouble[] coefficients = new double[getOriginalNumDecisionVariables()];\nInteger negativeVarBasicRow = getBasicRow(getNegativeDecisionVariableOffset());\ndouble mostNegative = negativeVarBasicRow == null ? 0 : getEntry(negativeVarBasicRow, getRhsOffset());\nSet<Integer> basicRows = new HashSet<Integer>();\nfor (int i = 0; i < coefficients.length; i++) {\nInteger basicRow = getBasicRow(getNumObjectiveFunctions() + i);\nif (basicRows.contains(basicRow)) {\ncoefficients[i] = 0;\nbasicRows.add(basicRow);\ncoefficients[i] =\nreturn new RealPointValuePair(coefficients, f.getValue(coefficients));\n}",
            "method_id": 1
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getBasicRow(IZ)Ljava/lang/Integer;",
            "method_body": "private Integer getBasicRow(final int col, boolean ignoreObjectiveRows) {\nInteger row = null;\nint start = getNumObjectiveFunctions();\nfor (int i = start; i < getHeight(); i++) {\nif (MathUtils.equals(getEntry(i, col), 1.0, epsilon) && (row == null)) {\nrow = i;\n} else if (!MathUtils.equals(getEntry(i, col), 0.0, epsilon)) {\nreturn null;\nreturn row;\n}",
            "method_id": 2
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:discardArtificialVariables()V",
            "method_body": "protected void discardArtificialVariables() {\nif (numArtificialVariables == 0) {\nint width = getWidth() - numArtificialVariables - 1;\nint height = getHeight() - 1;\ndouble[][] matrix = new double[height][width];\nfor (int i = 0; i < height; i++) {\nfor (int j = 0; j < width - 1; j++) {\nmatrix[i][j] = getEntry(i + 1, j + 1);\nmatrix[i][width - 1] = getEntry(i + 1, getRhsOffset());\nthis.tableau = new Array2DRowRealMatrix(matrix);\nthis.numArtificialVariables = 0;\n}",
            "method_id": 3
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:normalize(Lorg/apache/commons/math/optimization/linear/LinearConstraint;)Lorg/apache/commons/math/optimization/linear/LinearConstraint;",
            "method_body": "private LinearConstraint normalize(final LinearConstraint constraint) {\nif (constraint.getValue() < 0) {\nreturn new LinearConstraint(constraint.getCoefficients(),\n}",
            "method_id": 4
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getConstraintTypeCounts(Lorg/apache/commons/math/optimization/linear/Relationship;)I",
            "method_body": "private int getConstraintTypeCounts(final Relationship relationship) {\nint count = 0;\nfor (final LinearConstraint constraint : constraints) {\nif (constraint.getRelationship() == relationship) {\n++count;\nreturn count;\n}",
            "method_id": 5
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getNegativeDecisionVariableOffset()I",
            "method_body": "protected final int getNegativeDecisionVariableOffset() {\nreturn getNumObjectiveFunctions() + getOriginalNumDecisionVariables();\n}",
            "method_id": 6
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getOriginalNumDecisionVariables()I",
            "method_body": "protected final int getOriginalNumDecisionVariables() {\nreturn restrictToNonNegative ? numDecisionVariables : numDecisionVariables - 1;\n}",
            "method_id": 7
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getRhsOffset()I",
            "method_body": "protected final int getRhsOffset() {\nreturn getWidth() - 1;\n}",
            "method_id": 8
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getNumArtificialVariables()I",
            "method_body": "protected final int getNumArtificialVariables() {\nreturn numArtificialVariables;\n}",
            "method_id": 9
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getNormalizedConstraints()Ljava/util/List;",
            "method_body": "public List<LinearConstraint> getNormalizedConstraints() {\nList<LinearConstraint> normalized = new ArrayList<LinearConstraint>();\nfor (LinearConstraint constraint : constraints) {\nnormalized.add(normalize(constraint));\nreturn normalized;\n}",
            "method_id": 10
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getWidth()I",
            "method_body": "protected final int getWidth() {\nreturn tableau.getColumnDimension();\n}",
            "method_id": 11
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getHeight()I",
            "method_body": "protected final int getHeight() {\nreturn tableau.getRowDimension();\n}",
            "method_id": 12
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getEntry(II)D",
            "method_body": "protected final double getEntry(final int row, final int column) {\nreturn tableau.getEntry(row, column);\n}",
            "method_id": 13
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getArtificialVariableOffset()I",
            "method_body": "protected final int getArtificialVariableOffset() {\nreturn getNumObjectiveFunctions() + numDecisionVariables + numSlackVariables;\n}",
            "method_id": 14
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getBasicRow(I)Ljava/lang/Integer;",
            "method_body": "private Integer getBasicRow(final int col) {\nreturn getBasicRow(col, true);\n}",
            "method_id": 15
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getNumVariables()I",
            "method_body": "public int getNumVariables() {\nreturn f.getCoefficients().getDimension();\n}",
            "method_id": 16
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:getNumObjectiveFunctions()I",
            "method_body": "protected final int getNumObjectiveFunctions() {\nreturn this.numArtificialVariables > 0 ? 2 : 1;\n}",
            "method_id": 17
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:<init>(Lorg/apache/commons/math/optimization/linear/LinearObjectiveFunction;Ljava/util/Collection;Lorg/apache/commons/math/optimization/GoalType;ZD)V",
            "method_body": "SimplexTableau(final LinearObjectiveFunction f,\nfinal double epsilon) {\nthis.f                      = f;\nthis.constraints            = constraints;\nthis.restrictToNonNegative  = restrictToNonNegative;\nthis.epsilon                = epsilon;\nthis.numDecisionVariables   = getNumVariables() + (restrictToNonNegative ? 0 : 1);\nthis.numSlackVariables      = getConstraintTypeCounts(Relationship.LEQ) +\nthis.numArtificialVariables = getConstraintTypeCounts(Relationship.EQ) +\nthis.tableau = new Array2DRowRealMatrix(createTableau(goalType == GoalType.MAXIMIZE));\ninitialize();\n}",
            "method_id": 18
        },
        {
            "method_signature": "org.apache.commons.math.optimization.linear.SimplexTableau:initialize()V",
            "method_body": "private void initialize() {\nfor (int artificialVar = 0; artificialVar < numArtificialVariables; artificialVar++) {\nint row = getBasicRow(getArtificialVariableOffset() + artificialVar);\nsubtractRow(0, row, 1.0);\n}",
            "method_id": 19
        }
    ]
}