{
    "bug_id": 52,
    "test_id": 4,
    "test_name": "org.jsoup.nodes.DocumentTest.testMetaCharsetUpdateXmlIso8859",
    "test_body": "public void testMetaCharsetUpdateXmlIso8859() {\nfinal Document doc = createXmlDocument(\"1.0\", \"changeThis\", true);\ndoc.updateMetaCharsetElement(true);\ndoc.charset(Charset.forName(charsetIso8859));\n333: final String xmlCharsetISO = \"<?xml version=\\\"1.0\\\" encoding=\\\"\" + charsetIso8859 + \"\\\"?>\\n\" +\n\"<root>\\n\" +\n\" node\\n\" +\n\"</root>\";\nassertEquals(xmlCharsetISO, doc.toString());\n339: XmlDeclaration selectedNode = (XmlDeclaration) doc.childNode(0);\nassertEquals(charsetIso8859, doc.charset().name());\nassertEquals(charsetIso8859, selectedNode.attr(\"encoding\"));\nassertEquals(doc.charset(), doc.outputSettings().charset());\n}\n",
    "stack_trace": "junit.framework.AssertionFailedError: expected:<...ncoding=\"ISO-8859-1\"[?]>\n<root>\nnode\n</roo...> but was:<...ncoding=\"ISO-8859-1\"[]>\n<root>\nnode\n</roo...>\nat org.junit.Assert.assertEquals(Assert.java:115)\nat org.junit.Assert.assertEquals(Assert.java:144)\nat org.jsoup.nodes.DocumentTest.testMetaCharsetUpdateXmlIso8859(DocumentTest.java:337)",
    "covered_methods": [
        {
            "method_signature": "org.jsoup.nodes.Element:prependChild(Lorg/jsoup/nodes/Node;)Lorg/jsoup/nodes/Element;",
            "method_body": "public Element prependChild(Node child) {\nValidate.notNull(child);\naddChildren(0, child);\nreturn this;\n}",
            "method_id": 40
        },
        {
            "method_signature": "org.jsoup.nodes.Element:appendElement(Ljava/lang/String;)Lorg/jsoup/nodes/Element;",
            "method_body": "public Element appendElement(String tagName) {\nElement child = new Element(Tag.valueOf(tagName), baseUri());\nappendChild(child);\nreturn child;\n}",
            "method_id": 41
        },
        {
            "method_signature": "org.jsoup.nodes.Element:empty()Lorg/jsoup/nodes/Element;",
            "method_body": "public Element empty() {\nchildNodes.clear();\nreturn this;\n}",
            "method_id": 42
        },
        {
            "method_signature": "org.jsoup.nodes.Element:preserveWhitespace(Lorg/jsoup/nodes/Node;)Z",
            "method_body": "static boolean preserveWhitespace(Node node) {\nif (node != null && node instanceof Element) {\nElement element = (Element) node;\nreturn element.tag.preserveWhitespace() ||\n}",
            "method_id": 43
        },
        {
            "method_signature": "org.jsoup.nodes.Element:text(Ljava/lang/String;)Lorg/jsoup/nodes/Element;",
            "method_body": "public Element text(String text) {\nValidate.notNull(text);\nempty();\nTextNode textNode = new TextNode(text, baseUri);\nappendChild(textNode);\nreturn this;\n}",
            "method_id": 44
        },
        {
            "method_signature": "org.jsoup.nodes.Element:outerHtmlHead(Ljava/lang/Appendable;ILorg/jsoup/nodes/Document$OutputSettings;)V",
            "method_body": "void outerHtmlHead(Appendable accum, int depth, Document.OutputSettings out) throws IOException {\nif (out.prettyPrint() && (tag.formatAsBlock() || (parent() != null && parent().tag().formatAsBlock()) || out.outline())) {\nif (accum instanceof StringBuilder) {\nif (((StringBuilder) accum).length() > 0)\nindent(accum, depth, out);\naccum\nattributes.html(accum, out);\nif (childNodes.isEmpty() && tag.isSelfClosing()) {\naccum.append(\">\");\n}",
            "method_id": 45
        },
        {
            "method_signature": "org.jsoup.nodes.Element:outerHtmlTail(Ljava/lang/Appendable;ILorg/jsoup/nodes/Document$OutputSettings;)V",
            "method_body": "void outerHtmlTail(Appendable accum, int depth, Document.OutputSettings out) throws IOException {\nif (!(childNodes.isEmpty() && tag.isSelfClosing())) {\nif (out.prettyPrint() && (!childNodes.isEmpty() && (\nindent(accum, depth, out);\naccum.append(\"</\").append(tagName()).append(\">\");\n}",
            "method_id": 46
        },
        {
            "method_signature": "org.jsoup.nodes.Element:html()Ljava/lang/String;",
            "method_body": "public String html() {\nStringBuilder accum = new StringBuilder();\nhtml(accum);\nreturn getOutputSettings().prettyPrint() ? accum.toString().trim() : accum.toString();\n}",
            "method_id": 47
        },
        {
            "method_signature": "org.jsoup.nodes.Element:html(Ljava/lang/StringBuilder;)V",
            "method_body": "private void html(StringBuilder accum) {\nfor (Node node : childNodes)\nnode.outerHtml(accum);\n}",
            "method_id": 48
        },
        {
            "method_signature": "org.jsoup.nodes.Element:toString()Ljava/lang/String;",
            "method_body": "public String toString() {\nreturn outerHtml();\n}",
            "method_id": 49
        },
        {
            "method_signature": "org.jsoup.nodes.Document:<init>(Ljava/lang/String;)V",
            "method_body": "private OutputSettings outputSettings = new OutputSettings();\nprivate QuirksMode quirksMode = QuirksMode.noQuirks;\nprivate boolean updateMetaCharset = false;\nsuper(Tag.valueOf(\"#root\"), baseUri);\nthis.location = baseUri;\n}",
            "method_id": 50
        },
        {
            "method_signature": "org.jsoup.nodes.Document:outerHtml()Ljava/lang/String;",
            "method_body": "public String outerHtml() {\nreturn super.html(); // no outer wrapper tag\n}",
            "method_id": 51
        },
        {
            "method_signature": "org.jsoup.nodes.Document:charset(Ljava/nio/charset/Charset;)V",
            "method_body": "public void charset(Charset charset) {\nupdateMetaCharsetElement(true);\noutputSettings.charset(charset);\nensureMetaCharsetElement();\n}",
            "method_id": 52
        },
        {
            "method_signature": "org.jsoup.nodes.Document:charset()Ljava/nio/charset/Charset;",
            "method_body": "public Charset charset() {\nreturn outputSettings.charset();\n}",
            "method_id": 53
        },
        {
            "method_signature": "org.jsoup.nodes.Document:updateMetaCharsetElement(Z)V",
            "method_body": "public void updateMetaCharsetElement(boolean update) {\nthis.updateMetaCharset = update;\n}",
            "method_id": 54
        },
        {
            "method_signature": "org.jsoup.nodes.Document:ensureMetaCharsetElement()V",
            "method_body": "private void ensureMetaCharsetElement() {\nif (updateMetaCharset) {\nOutputSettings.Syntax syntax = outputSettings().syntax();\nif (syntax == OutputSettings.Syntax.html) {\n} else if (syntax == OutputSettings.Syntax.xml) {\nNode node = childNodes().get(0);\nif (node instanceof XmlDeclaration) {\nXmlDeclaration decl = (XmlDeclaration) node;\nif (decl.name().equals(\"xml\")) {\ndecl.attr(\"encoding\", charset().displayName());\nfinal String version = decl.attr(\"version\");\nif (version != null) {\ndecl.attr(\"version\", \"1.0\");\n} else {\n} else {\nXmlDeclaration decl = new XmlDeclaration(\"xml\", baseUri, false);\ndecl.attr(\"version\", \"1.0\");\ndecl.attr(\"encoding\", charset().displayName());\nprependChild(decl);\n}",
            "method_id": 55
        },
        {
            "method_signature": "org.jsoup.nodes.Document:outputSettings()Lorg/jsoup/nodes/Document$OutputSettings;",
            "method_body": "public OutputSettings outputSettings() {\nreturn outputSettings;\n}",
            "method_id": 56
        },
        {
            "method_signature": "org.jsoup.parser.Tag:<init>(Ljava/lang/String;)V",
            "method_body": "private static final Map<String, Tag> tags = new HashMap<String, Tag>(); // map of known tags\nprivate boolean isBlock = true; // block or inline\nprivate boolean formatAsBlock = true; // should be formatted as a block\nprivate boolean canContainBlock = true; // Can this tag hold block level tags?\nprivate boolean canContainInline = true; // only pcdata if not\nprivate boolean empty = false; // can hold nothing; e.g. img\nprivate boolean selfClosing = false; // can self close (<foo />). used for unknown tags that self close, without forcing them as empty.\nprivate boolean preserveWhitespace = false; // for pre, textarea, script etc\nprivate boolean formList = false; // a control that appears in forms: input, textarea, output etc\nprivate boolean formSubmit = false; // a control that can be submitted in a form: input etc\nprivate Tag(String tagName) {\nthis.tagName = tagName.toLowerCase();\n}",
            "method_id": 57
        },
        {
            "method_signature": "org.jsoup.parser.Tag:<clinit>()V",
            "method_body": "private static final String[] blockTags = {\n};",
            "method_id": 58
        },
        {
            "method_signature": "org.jsoup.parser.Tag:getName()Ljava/lang/String;",
            "method_body": "public String getName() {\nreturn tagName;\n}",
            "method_id": 59
        }
    ]
}