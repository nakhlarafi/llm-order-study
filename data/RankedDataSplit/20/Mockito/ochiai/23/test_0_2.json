{
    "bug_id": 23,
    "test_id": 0,
    "test_name": "org.mockitousage.stubbing.DeepStubsSerializableTest.should_serialize_and_deserialize_mock_created_by_deep_stubs",
    "test_body": "public void should_serialize_and_deserialize_mock_created_by_deep_stubs() throws Exception {\n// given\nSampleClass sampleClass = mock(SampleClass.class, withSettings().defaultAnswer(Mockito.RETURNS_DEEP_STUBS).serializable());\nwhen(sampleClass.getSample().isSth()).thenReturn(STUBBED_BOOLEAN_VALUE);\nwhen(sampleClass.getSample().getNumber()).thenReturn(STUBBED_INTEGER_VALUE);\n24: // when\nObject o = SimpleSerializationUtil.serializeAndBack(sampleClass);\n27: // then\nassertThat(o).isInstanceOf(SampleClass.class);\nSampleClass deserializedSample = (SampleClass) o;\nassertThat(deserializedSample.getSample().isSth()).isEqualTo(STUBBED_BOOLEAN_VALUE);\nassertThat(deserializedSample.getSample().getNumber()).isEqualTo(STUBBED_INTEGER_VALUE);\n}\n",
    "stack_trace": "java.io.NotSerializableException: org.mockito.internal.stubbing.defaultanswers.ReturnsDeepStubs$2\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1184)\nat java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:348)\nat java.util.concurrent.ConcurrentLinkedQueue.writeObject(ConcurrentLinkedQueue.java:769)\nat sun.reflect.GeneratedMethodAccessor33.invoke(Unknown Source)\nat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\nat java.lang.reflect.Method.invoke(Method.java:498)\nat java.io.ObjectStreamClass.invokeWriteObject(ObjectStreamClass.java:1140)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1496)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.defaultWriteFields(ObjectOutputStream.java:1548)\nat java.io.ObjectOutputStream.writeSerialData(ObjectOutputStream.java:1509)\nat java.io.ObjectOutputStream.writeOrdinaryObject(ObjectOutputStream.java:1432)\nat java.io.ObjectOutputStream.writeObject0(ObjectOutputStream.java:1178)\nat java.io.ObjectOutputStream.writeObject(ObjectOutputStream.java:348)\nat org.mockitoutil.SimpleSerializationUtil.serializeMock(SimpleSerializationUtil.java:34)\nat org.mockitoutil.SimpleSerializationUtil.serializeAndBack(SimpleSerializationUtil.java:16)\nat org.mockitousage.stubbing.DeepStubsSerializableTest.should_serialize_and_deserialize_mock_created_by_deep_stubs(DeepStubsSerializableTest.java:25)",
    "covered_methods": [
        {
            "method_signature": "org.mockito.internal.handler.InvocationNotifierHandler:getInvocationContainer()Lorg/mockito/internal/stubbing/InvocationContainer;",
            "method_body": "public InvocationContainer getInvocationContainer() {\nreturn mockHandler.getInvocationContainer();\n}",
            "method_id": 40
        },
        {
            "method_signature": "org.mockito.internal.stubbing.answers.Returns:<init>(Ljava/lang/Object;)V",
            "method_body": "public Returns(Object value) {\nthis.value = value;\n}",
            "method_id": 41
        },
        {
            "method_signature": "org.mockito.internal.stubbing.ConsecutiveStubbing:<init>(Lorg/mockito/internal/stubbing/InvocationContainerImpl;)V",
            "method_body": "public ConsecutiveStubbing(InvocationContainerImpl invocationContainerImpl) {\nthis.invocationContainerImpl = invocationContainerImpl;\n}",
            "method_id": 42
        },
        {
            "method_signature": "org.mockito.internal.verification.DefaultRegisteredInvocations:isEmpty()Z",
            "method_body": "public boolean isEmpty() {\nsynchronized (invocations) {\nreturn invocations.isEmpty();\n}",
            "method_id": 43
        },
        {
            "method_signature": "org.mockito.internal.stubbing.answers.MethodInfo:isVoid()Z",
            "method_body": "public boolean isVoid() {\nreturn this.method.getReturnType() == Void.TYPE;\n}",
            "method_id": 44
        },
        {
            "method_signature": "org.mockito.internal.stubbing.OngoingStubbingImpl:thenAnswer(Lorg/mockito/stubbing/Answer;)Lorg/mockito/stubbing/OngoingStubbing;",
            "method_body": "public OngoingStubbing<T> thenAnswer(Answer<?> answer) {\nif(!invocationContainerImpl.hasInvocationForPotentialStubbing()) {\ninvocationContainerImpl.addAnswer(answer);\nreturn new ConsecutiveStubbing<T>(invocationContainerImpl);\n}",
            "method_id": 45
        },
        {
            "method_signature": "org.mockito.internal.stubbing.InvocationContainerImpl:hasInvocationForPotentialStubbing()Z",
            "method_body": "public boolean hasInvocationForPotentialStubbing() {\nreturn !registeredInvocations.isEmpty();\n}",
            "method_id": 46
        },
        {
            "method_signature": "org.mockito.internal.verification.DefaultRegisteredInvocations:removeLast()V",
            "method_body": "public void removeLast() {\nsynchronized (invocations) {\nif (! invocations.isEmpty()) {\ninvocations.removeLast();\n}\n}",
            "method_id": 47
        },
        {
            "method_signature": "org.mockito.internal.MockitoCore:when(Ljava/lang/Object;)Lorg/mockito/stubbing/OngoingStubbing;",
            "method_body": "public <T> OngoingStubbing<T> when(T methodCall) {\nmockingProgress.stubbingStarted();\nreturn (OngoingStubbing) stub();\n}",
            "method_id": 48
        },
        {
            "method_signature": "org.mockito.Mockito:when(Ljava/lang/Object;)Lorg/mockito/stubbing/OngoingStubbing;",
            "method_body": "public static <T> OngoingStubbing<T> when(T methodCall) {\nreturn MOCKITO_CORE.when(methodCall);\n}",
            "method_id": 49
        },
        {
            "method_signature": "org.mockito.internal.stubbing.InvocationContainerImpl:addAnswer(Lorg/mockito/stubbing/Answer;)V",
            "method_body": "public void addAnswer(Answer answer) {\nregisteredInvocations.removeLast();\naddAnswer(answer, false);\n}",
            "method_id": 50
        },
        {
            "method_signature": "org.mockito.internal.MockitoCore:stub()Lorg/mockito/internal/progress/IOngoingStubbing;",
            "method_body": "public IOngoingStubbing stub() {\nIOngoingStubbing stubbing = mockingProgress.pullOngoingStubbing();\nif (stubbing == null) {\nreturn stubbing;\n}",
            "method_id": 51
        },
        {
            "method_signature": "org.mockito.internal.stubbing.StubbedInvocationMatcher:answer(Lorg/mockito/invocation/InvocationOnMock;)Ljava/lang/Object;",
            "method_body": "public Object answer(InvocationOnMock invocation) throws Throwable {\nsynchronized(answers) {\na = answers.size() == 1 ? answers.peek() : answers.poll();\n}\nreturn a.answer(invocation);\n}",
            "method_id": 52
        },
        {
            "method_signature": "org.mockito.internal.stubbing.StubbedInvocationMatcher:markStubUsed(Lorg/mockito/invocation/DescribedInvocation;)V",
            "method_body": "public void markStubUsed(DescribedInvocation usedAt) {\nthis.usedAt = usedAt;\n}",
            "method_id": 53
        },
        {
            "method_signature": "org.mockito.internal.invocation.InvocationImpl:markStubbed(Lorg/mockito/invocation/StubInfo;)V",
            "method_body": "public void markStubbed(StubInfo stubInfo) {\nthis.stubInfo = stubInfo;\n}",
            "method_id": 54
        },
        {
            "method_signature": "org.mockito.internal.invocation.StubInfoImpl:<init>(Lorg/mockito/invocation/DescribedInvocation;)V",
            "method_body": "public StubInfoImpl(DescribedInvocation stubbedAt) {\nthis.stubbedAt = stubbedAt;\n}",
            "method_id": 55
        },
        {
            "method_signature": "org.mockito.Mockito:mock(Ljava/lang/Class;Lorg/mockito/MockSettings;)Ljava/lang/Object;",
            "method_body": "public static <T> T mock(Class<T> classToMock, MockSettings mockSettings) {\nreturn MOCKITO_CORE.mock(classToMock, mockSettings);\n}",
            "method_id": 56
        },
        {
            "method_signature": "org.mockito.internal.progress.ThreadSafeMockingProgress:pullOngoingStubbing()Lorg/mockito/internal/progress/IOngoingStubbing;",
            "method_body": "public IOngoingStubbing pullOngoingStubbing() {\nreturn threadSafely().pullOngoingStubbing();\n}",
            "method_id": 57
        },
        {
            "method_signature": "org.mockito.internal.progress.MockingProgressImpl:pullOngoingStubbing()Lorg/mockito/internal/progress/IOngoingStubbing;",
            "method_body": "public IOngoingStubbing pullOngoingStubbing() {\nIOngoingStubbing temp = iOngoingStubbing;\niOngoingStubbing = null;\nreturn temp;\n}",
            "method_id": 58
        },
        {
            "method_signature": "org.mockito.internal.creation.CglibMockMaker:createMock(Lorg/mockito/mock/MockCreationSettings;Lorg/mockito/invocation/MockHandler;)Ljava/lang/Object;",
            "method_body": "public <T> T createMock(MockCreationSettings<T> settings, MockHandler handler) {\nInternalMockHandler mockitoHandler = cast(handler);\nnew AcrossJVMSerializationFeature().enableSerializationAcrossJVM(settings);\nreturn ClassImposterizer.INSTANCE.imposterise(\n}",
            "method_id": 59
        }
    ]
}